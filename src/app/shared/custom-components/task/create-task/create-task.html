<form [formGroup]="taskForm" (ngSubmit)="handleTask()" class="flex flex-col">
  <div class="flex flex-col pb-2 pt-1">
    <label for="">Title</label>
    <input
      z-input
      type="text"
      placeholder="Title of task"
      formControlName="title"
      zSize="lg"
      class="text-secondary-foreground text-sm"
    />

    @if (taskForm.get('title')?.touched && taskForm.get('title')?.invalid) {
      @if (taskForm.get('title')?.errors?.['required']) {
        <span class="text-destructive"> task title is required</span>
      } @else if (
        taskForm.get('title')?.errors?.['minlength'] || taskForm.get('title')?.errors?.['maxlength']
      ) {
        <span class="text-destructive">title can be of 2-50 characters</span>
      }
    }
  </div>

  <div class="flex flex-col pb-2 pt-1">
    <label for="">Description</label>
    <textarea
      z-input
      rows="5"
      placeholder="Description of task"
      formControlName="description"
      class="w-full text-secondary-foreground"
    ></textarea>

    @if (taskForm.get('description')?.errors?.['maxlength']) {
      <span class="text-destructive">description can be of 255 characters</span>
    }
  </div>

  <div class="flex flex-col md:flex-row gap-4 pb-2 pt-1">
    <div class="flex flex-col flex-1">
      <label for="">Project</label>
      <z-select id="project" formControlName="project" placeholder="Select project">
        @for (project of projects; track project.value) {
          <z-select-item [zValue]="project.value">{{ project.label }}</z-select-item>
        }
      </z-select>

      @if (taskForm.get('project')?.touched && taskForm.get('project')?.invalid) {
        @if (taskForm.get('project')?.errors?.['required']) {
          <span class="text-destructive"> select the project</span>
        }
      }
    </div>

    <div class="flex flex-col flex-1">
      <label for="">Assigned to</label>
      <z-select id="assignedTo" formControlName="assignedTo" placeholder="Select assignedTo">
        @for (assignedTo of members; track assignedTo.value) {
          <z-select-item [zValue]="assignedTo.value">{{ assignedTo.label }}</z-select-item>
        }
      </z-select>
      @if (taskForm.get('assignedTo')?.touched && taskForm.get('assignedTo')?.invalid) {
        @if (taskForm.get('assignedTo')?.errors?.['required']) {
          <span class="text-destructive"> assigned is required</span>
        }
      }
    </div>
  </div>

  <div class="flex flex-col md:flex-row gap-4 pb-2 pt-1">
    <div class="flex flex-col flex-1">
      <label for="">Due Date</label>
      <z-date-picker
        [value]="selectedDate()"
        placeholder="Pick a date"
        (dateChange)="onDateChange($event)"
        zFormat="dd-MM-yyyy"
        formControlName="dueDate"
        zSize="default"
        zType="date"
      />

      @if (taskForm.get('dueDate')?.touched && taskForm.get('dueDate')?.invalid) {
        @if (taskForm.get('dueDate')?.errors?.['required']) {
          <span class="text-destructive"> please select the date</span>
        }
      }
    </div>

    <div class="flex flex-col flex-1">
      <label for="">Priority</label>
      <z-select id="assignedTo" formControlName="priority" placeholder="Select assignedTo">
        @for (priority of priority; track priority.value) {
          <z-select-item [zValue]="priority.value">{{ priority.label }}</z-select-item>
        }
      </z-select>

      @if (taskForm.get('priority')?.touched && taskForm.get('priority')?.invalid) {
        @if (taskForm.get('priority')?.errors?.['required']) {
          <span class="text-destructive"> please select the priority</span>
        }
      }
    </div>
  </div>

  <button z-button type="submit" class="mt-3">Create</button>
</form>

<!--  title,description,duedate,assigned to,status,priority,project -->
